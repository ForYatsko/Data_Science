##### Домашняя работа №5
  
Домашняя работа №5
Реализовать минимум 5 регрессоров, сравнить метрики между собой, выбрать лучший для Вашего датасета. Можно использовать любой свой датасет.

Регрессоры:
✓ Регрессор Gradient Boosting.
✓ Регрессор LGBM.
✓ Экстремальный градиентный бустинг.
✓ Регрессор Extra Trees.
✓ Регрессор случайного леса. 
✓ Регрессор CatBoost.
✓ Регрессор AdaBoost.
✓ Регрессия Лассо.	
✓ Гребневая регрессия. 
✓ Байесовская регрессия.
✓ Линейная регрессия.
✓ Регрессор Губера.
✓ Регрессор дерева решений.
✓ Ортогональный поиск соответствия.
✓ Пассивно-агрессивный регрессор. 
✓ Регрессор K-ближайших соседей.
✓ Фиктивный регрессор.
✓ Elastic Net.
✓ Ансамбль регрессоров.

##### Структура проекта

hw5/

├── hw5.ipynb                    # Реализация в юпитер ноутбуке

├── requirements.txt             # Список зависимостей для установки

├── regressor.py                 # Модуль для создания регрессоров

├── save.py                      # Модуль для сохранения результатов

├── visualization.py             # Модуль для построения графиков

├── my_logging.py                # Настройка логирования

├── output/                      # Папка для сохранения графиков и результатов

│   ├── predictions_vs_actual.png    # График предсказаний и истинных значений

│   ├── residuals_distribution.png   # График распределения остатков

│   ├── residuals_vs_predictions.png # График остатков против предсказаний

└── README.md                    # Описание проекта

##### Датасет: https://scikit-learn.org/stable/modules/generated/sklearn.datasets.fetch_california_housing.html

Потенциальные проблемы датасета

Дисбаланс данных:
Большинство значений целевой переменной сосредоточены в диапазоне от 0 до 3, с редкими значениями выше 4.
Асимметрия данных может усложнить предсказания для редких случаев.

Влияние выбросов:
Зоны с необычно высокими или низкими значениями (например, доход или стоимость домов) могут влиять на результаты моделей.

Линейность признаков:
Не все признаки имеют линейную связь с целевой переменной, что требует использования нелинейных моделей (например, LightGBM).

##### Основные этапы работы:
1. Импорт библиотек и настройка окружения

2. Загрузка данных
Используется датасет California Housing, который содержит данные о характеристиках жилья в Калифорнии и их стоимости.
Целевая переменная: MedHouseVal (медианная стоимость домов).

3. Обработка данных
Проверка на пропущенные значения.
Описание данных (основные статистики и типы данных).
Визуализация распределения целевой переменной.

4. Разделение данных
Данные делятся на обучающую и тестовую выборки в соотношении 80/20.

5. Подготовка регрессоров
С помощью функции build_regressors создается несколько моделей для обучения (например, LightGBM, Random Forest и другие).

6. Обучение моделей
Каждая модель обучается на обучающей выборке.
Выполняются предсказания на тестовой выборке.
Для каждой модели вычисляются метрики качества:
MSE (среднеквадратичная ошибка),
MAE (средняя абсолютная ошибка),
R² (коэффициент детерминации).

7. Визуализация результатов

8. Выбор лучшего регрессора
Лучшая модель определяется по минимальному значению MSE.

9. Повторное обучение LightGBM:
Если LightGBM является лучшей моделью, она переобучается с учетом дисбаланса данных, используя веса выборок.
10. Сохранение результатов
Метрики и визуализации сохраняются в папке output.
Результаты моделей записываются в файл CSV.

##### Рекомендации
Использовать LightGBM как основную модель для предсказания медианной стоимости жилья, так как она показала лучшие результаты.
